<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ChainMinds - Manufacturer NFC</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="css/admin-createAcc.css" />

    <style>
      .logo {
        text-align: center;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      }

      .logo img {
        width: 100%;
        max-width: 80px; /* control logo size */
        height: auto;
        border-radius: 8px; /* optional, makes it smooth */
      }
      .form-box {
        background-color: #e1efe4;
        border-radius: 10px;
        padding: 30px 40px;
        margin-top: 30px;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        border: 1px solid #bcd3c3;
      }
      .form-box h4 {
        text-align: center;
        font-weight: 700;
        color: #2c3e50;
      }
      .form-box h6 {
        text-align: center;
        color: #5b6b61;
        margin-bottom: 20px;
      }
      label {
        font-size: 0.9rem;
        color: #3e4d43;
        font-weight: 500;
      }
      input.form-control {
        border-radius: 6px;
      }
      .btn-create {
        background-color: #2d7749;
        color: white;
        border: none;
        padding: 8px 18px;
        border-radius: 6px;
        transition: 0.3s;
      }
      .btn-create:hover {
        background-color: #255d3a;
      }
      .btn-nfc {
        background-color: #2d7749;
        color: white;
        border: none;
        width: 100%;
        padding: 12px;
        border-radius: 30px;
        font-weight: 600;
        transition: 0.3s;
      }
      .btn-nfc:hover {
        background-color: #255d3a;
      }
      #msg {
        text-align: center;
        margin-top: 10px;
        font-weight: 500;
      }
    </style>
  </head>
  <body>
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="logo">
        <img src="photos/ChainMindsLogo.png" alt="Logo" />
      </div>
      <div class="menu">
        <a href="Manufacturer-home.html">üè† Home</a>
        <a href="Manufacturer-addBatch&Nfc.html" class="active"
          >üìÑ BatchID & NFC</a
        >
        <a href="#">üìù Feed Backs</a>
        <a href="#">‚öôÔ∏è Settings</a>
      </div>
      <div class="logout">
        <a href="manufacturer-login.html">‚¨Ö Logout</a>
      </div>
    </div>
    <!-- Topbar -->
    <div class="topbar">
      <div class="profile">
        <span>üîî</span>
        <span>Admin_1</span>
        <img src="photos/puzzle.jpg" alt="Profile" />
      </div>
    </div>

    <div class="content">
      <!-- Main Content -->
      <div class="main">
        <div class="form-box">
          <h4>ChainMinds</h4>
          <h6>SCM-BC</h6>

          <form id="batchForm">
            <div class="row mb-3">
              <div class="col-md-6">
                <label>Manufacturer Name:</label>
                <input
                  type="text"
                  id="manufacturer"
                  class="form-control"
                  required
                />
              </div>
              <div class="col-md-6">
                <label>Location:</label>
                <input
                  type="text"
                  id="location"
                  class="form-control"
                  placeholder="enter your location"
                  required
                />
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-6">
                <label>City:</label>
                <input type="text" id="city" class="form-control" required />
              </div>
              <div class="col-md-6">
                <label>Zip-code:</label>
                <input type="text" id="zip" class="form-control" required />
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-6">
                <label>Product Name:</label>
                <input type="text" id="product" class="form-control" required />
              </div>
              <div class="col-md-6">
                <label>Product Weight:</label>
                <input
                  type="text"
                  id="product-weight"
                  class="form-control"
                  required
                />
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-6">
                <label>Harvest Date:</label>
                <input
                  type="date"
                  id="harvestDate"
                  class="form-control"
                  required
                />
              </div>
              <div class="col-md-6">
                <label>Expaire Date:</label>
                <input
                  type="date"
                  id="expaireDate"
                  class="form-control"
                  required
                />
              </div>
            </div>
            <div class="col-md-6 d-flex align-items-end">
              <label class="me-2">Create Batch ID:</label>
              <input
                type="text"
                id="batchId"
                class="form-control me-2"
                readonly
              />
              <button
                type="button"
                class="btn-create"
                onclick="generateBatch()"
              >
                Create
              </button>
            </div>
            <div class="mt-4">
              <label>Write to NFC:</label>
              <button type="button" class="btn-nfc mt-2" onclick="writeToNFC()">
                Write to NFC
              </button>
              <div id="msg"></div>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script>
      function generateBatch() {
        const randomId = "BATCH-" + Math.floor(1000 + Math.random() * 9000);
        document.getElementById("batchId").value = randomId;
      }

      async function writeToNFC() {
        const msg = document.getElementById("msg");
        const batchId = document.getElementById("batchId").value;
        if (!batchId) {
          msg.textContent = "‚ö†Ô∏è Please create a Batch ID first!";
          msg.style.color = "red";
          return;
        }

        if (!("NDEFReader" in window)) {
          msg.textContent =
            "‚ùå Web NFC not supported. Use Chrome on Android with HTTPS.";
          msg.style.color = "red";
          return;
        }

        try {
          const ndef = new NDEFReader();
          await ndef.write(batchId);
          msg.textContent = "‚úÖ NFC Tag written successfully!";
          msg.style.color = "green";
        } catch (err) {
          msg.textContent = "‚ùå Write failed: " + err.message;
          msg.style.color = "red";
        }
      }
    </script>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />
  </body>
</html>
